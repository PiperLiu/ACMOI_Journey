<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [3745. 牛的学术圈 I（双指针）](#3745-牛的学术圈-i双指针)

<!-- /code_chunk_output -->

### 3745. 牛的学术圈 I（双指针）

由于对计算机科学的热爱，以及有朝一日成为 「Bessie 博士」的诱惑，奶牛 Bessie 开始攻读计算机科学博士学位。

经过一段时间的学术研究，她已经发表了 $N$ 篇论文，并且她的第 $i$ 篇论文得到了来自其他研究文献的 $c_i$ 次引用。

Bessie 听说学术成就可以用 $h$ 指数来衡量。

$h$ 指数等于使得研究员有至少 $h$ 篇引用次数不少于 $h$ 的论文的最大整数 $h$。

例如，如果一名研究员有 $4$ 篇论文，引用次数分别为 $(1,100,2,3)$，则 $h$ 指数为 $2$，然而若引用次数为 $(1,100,3,3)$ 则 $h$ 指数将会是 $3$。

为了提升她的 $h$ 指数，Bessie 计划写一篇综述，并引用一些她曾经写过的论文。

由于页数限制，她至多可以在这篇综述中引用 $L$ 篇论文，并且<strong>她只能引用每篇她的论文至多一次</strong>。

请帮助 Bessie 求出在写完这篇综述后她可以达到的最大 $h$ 指数。

注意 Bessie 的导师可能会告知她纯粹为了提升 $h$ 指数而写综述存在违反学术道德的嫌疑；我们不建议其他学者模仿 Bessie 的行为。

<h4>输入格式</h4>

输入的第一行包含 $N$ 和 $L$。

第二行包含 $N$ 个空格分隔的整数 $c_1,…,c_N$。

<h4>输出格式</h4>

输出写完综述后 Bessie 可以达到的最大 $h$ 指数。

<h4>数据范围</h4>

- $1 \le N \le 10^5$,
- $0 \le c_i \le 10^5$,
- $0 \le L \le 10^5$

<h4>输入样例1：</h4>

```
4 0
1 100 2 3
```

<h4>输出样例1：</h4>

```
2
```

<h4>样例1解释</h4>

Bessie 不能引用任何她曾经写过的论文。上文中提到，$(1,100,2,3)$ 的 $h$ 指数为 $2$。

<h4>输入样例2：</h4>

```
4 1
1 100 2 3
```

<h4>输出样例2：</h4>

```
3
```

如果 Bessie 引用她的第三篇论文，引用数会变为 $(1,100,3,3)$。上文中提到，这一引用数的 $h$ 指数为 $3$。

```cpp
#include <iostream>
#include <cstring>
#include <algorithm>
using namespace std;

const int N = 1e5 + 10;
int n, L;
int q[N];

int main()
{
    scanf("%d%d", &n, &L);
    for (int i = 1; i <= n; ++ i) scanf("%d", &q[i]);
    sort(q + 1, q + n + 1, greater<int>());
    
    int res = 0;
    for (int h = 1, j = n; h <= n; ++ h)
    {
        // 找到最引用量最小的，但大于等于 h 的文献
        while (j && q[j] < h) -- j;
        // 如果此时第 h 小的文献引用量大于等于 h - 1
        // 并且需要额外引用的文献数量小于等于 L
        if (q[h] >= h - 1 && h - j <= L)
            res = h;
    }
    
    printf("%d\n", res);
}
```
